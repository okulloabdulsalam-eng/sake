<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="KIUMA - Kampala International University Muslim Students Association - Your guide to Islamic values, programs, and activities">
    <title>KIUMA - Kampala International University Muslim Students Association</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#4CAF50">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body class="home-page">
    <!-- Navigation Menu -->
    <nav class="nav-menu" id="navMenu">
        <div class="nav-header">
            <span class="nav-close" id="navClose"><i class="fas fa-times"></i></span>
        </div>
        <ul class="nav-list">
            <li><a href="index.html" class="nav-link active"><i class="fas fa-home"></i> Home</a></li>
            <li><a href="about.html" class="nav-link"><i class="fas fa-info-circle"></i> About</a></li>
            <li><a href="values.html" class="nav-link"><i class="fas fa-heart"></i> Values</a></li>
            <li><a href="programs.html" class="nav-link"><i class="fas fa-book"></i> Programs</a></li>
            <li><a href="activities.html" class="nav-link"><i class="fas fa-running"></i> Activities</a></li>
            <li><a href="events.html" class="nav-link"><i class="fas fa-calendar-alt"></i> Events</a></li>
            <li><a href="leadership.html" class="nav-link"><i class="fas fa-users"></i> Leadership</a></li>
            <li><a href="contact.html" class="nav-link"><i class="fas fa-phone"></i> Contact</a></li>
            <li><a href="counselling.html" class="nav-link"><i class="fas fa-hands-helping"></i> Counselling</a></li>
            <li><a href="library.html" class="nav-link"><i class="fas fa-book-open"></i> Library</a></li>
            <li><a href="media.html" class="nav-link"><i class="fas fa-photo-video"></i> Media</a></li>
            <li><a href="ask-question.html" class="nav-link"><i class="fas fa-question-circle"></i> Ask Question</a></li>
            <li><a href="join-programs.html" class="nav-link"><i class="fas fa-user-plus"></i> Join Programs</a></li>
            <li><a href="notifications.html" class="nav-link"><i class="fas fa-bell"></i> Notifications</a></li>
            <li><a href="pay.html" class="nav-link"><i class="fas fa-credit-card"></i> Pay</a></li>
            <li><a href="join-us.html" class="nav-link"><i class="fas fa-hand-holding-heart"></i> Join Us</a></li>
        </ul>
    </nav>

    <!-- Main Container -->
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <button class="menu-toggle" id="menuToggle"><i class="fas fa-bars"></i></button>
                <div class="logo-container">
                    <img src="logo.png" alt="KIUMA Logo" class="header-logo" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';" onload="this.style.display='block'; this.nextElementSibling.style.display='none';">
                    <svg class="header-logo-svg" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg" style="display: none;">
                        <!-- Outer Circle -->
                        <circle cx="100" cy="100" r="95" fill="none" stroke="#4CAF50" stroke-width="4"/>
                        <!-- Top Text Arc -->
                        <path id="topArc" d="M 20,100 A 80,80 0 0,1 180,100" fill="none"/>
                        <text fill="#4CAF50" font-size="9" font-weight="bold" font-family="Arial, sans-serif" letter-spacing="0.5">
                            <textPath href="#topArc" startOffset="50%" text-anchor="middle">
                                KAMPALA INTERNATIONAL UNIVERSITY
                            </textPath>
                        </text>
                        <!-- Bottom Text Arc -->
                        <path id="bottomArc" d="M 180,100 A 80,80 0 0,1 20,100" fill="none"/>
                        <text fill="#4CAF50" font-size="9" font-weight="bold" font-family="Arial, sans-serif" letter-spacing="0.5">
                            <textPath href="#bottomArc" startOffset="50%" text-anchor="middle">
                                MUSLIM ASSOCIATION
                            </textPath>
                        </text>
                        <!-- Mosque/Mihrab (Left) -->
                        <path d="M 50,75 L 50,115 L 58,115 L 58,105 L 63,100 L 58,95 L 58,85 Z" fill="none" stroke="#4CAF50" stroke-width="2"/>
                        <circle cx="56.5" cy="100" r="2" fill="#4CAF50"/>
                        <!-- Minaret (Center) -->
                        <rect x="88" y="65" width="10" height="45" fill="none" stroke="#4CAF50" stroke-width="2"/>
                        <rect x="90" y="75" width="6" height="2" fill="#4CAF50"/>
                        <rect x="90" y="85" width="6" height="2" fill="#4CAF50"/>
                        <rect x="90" y="95" width="6" height="2" fill="#4CAF50"/>
                        <polygon points="93,60 90,65 96,65" fill="#4CAF50"/>
                        <!-- Crescent and Star (Right) -->
                        <path d="M 140,92 A 12,12 0 0,1 128,92 A 10,10 0 0,0 140,92 Z" fill="#4CAF50"/>
                        <path d="M 130,88 L 131.5,92 L 136,92 L 132.5,94.5 L 134,99 L 130,96.5 L 126,99 L 127.5,94.5 L 124,92 L 128.5,92 Z" fill="#4CAF50"/>
                        <!-- KIUMA Text -->
                        <text x="100" y="145" font-size="22" font-weight="bold" fill="#4CAF50" text-anchor="middle" font-family="Arial, sans-serif" letter-spacing="2">KIUMA</text>
                    </svg>
                </div>
                <button class="notifications-btn" id="notificationsBtn">
                    <i class="fas fa-bell"></i>
                    <span class="badge">3</span>
                </button>
            </div>
        </header>

        <!-- Home Page Content -->
        <main class="main-content">
            <!-- Welcome Section -->
            <section class="welcome-section">
                <div>
                    <h2 class="greeting">
                        <a href="about.html">KIUMA</a>
                        <span>Assalam Alaikum, <span id="userName">Brother/Sister</span></span>
                    </h2>
                </div>
                <button class="account-icon-btn" id="accountIconBtn" onclick="toggleAccountModal()">
                    <i class="fas fa-user-circle" id="accountIcon"></i>
                </button>
            </section>

            <!-- Prayer Times Card -->
            <section class="promo-card prayer-times-card">
                <div class="card-badge">Prayer Times</div>
                <div class="card-content">
                    <div class="card-text">
                        <div class="hijri-date" id="hijriDate"></div>
                        <div class="date-display" id="dateDisplay"></div>
                        <div class="next-prayer" id="nextPrayer">
                            <i class="fas fa-clock"></i> Next: <span id="nextPrayerTime">Asr</span>
                        </div>
                    </div>
                    <div class="card-illustration">
                        <i class="fas fa-mosque" style="font-size: 60px; color: #4CAF50;"></i>
                    </div>
                </div>
            </section>

            <!-- Prayer Times List -->
            <section class="prayer-times-list" id="prayerTimesList">
                <div class="prayer-times-header">
                    <h3 style="margin: 0 0 15px 0; color: var(--dark-gray); font-size: 18px;">Prayer Times</h3>
                </div>
                
                <div class="prayer-table-header">
                    <div class="header-cell">Prayer</div>
                    <div class="header-cell">Adhan</div>
                    <div class="header-cell">Iqaama</div>
                </div>
                
                <!-- Prayer times - Edit times directly here in HTML -->
                <div class="prayer-item">
                    <span class="prayer-name">Fajr</span>
                    <span class="prayer-time adhan-time" id="fajrAdhan">05:40</span>
                    <span class="prayer-time iqaama-time" id="fajrIqaama">06:10</span>
                </div>
                <div class="prayer-item">
                    <span class="prayer-name">Dhuhr</span>
                    <span class="prayer-time adhan-time" id="dhuhrAdhan">13:00</span>
                    <span class="prayer-time iqaama-time" id="dhuhrIqaama">13:30</span>
                </div>
                <div class="prayer-item">
                    <span class="prayer-name">Asr</span>
                    <span class="prayer-time adhan-time" id="asrAdhan">16:00</span>
                    <span class="prayer-time iqaama-time" id="asrIqaama">16:30</span>
                </div>
                <div class="prayer-item">
                    <span class="prayer-name">Maghrib</span>
                    <span class="prayer-time adhan-time" id="maghribAdhan">19:05</span>
                    <span class="prayer-time iqaama-time" id="maghribIqaama">19:20</span>
                </div>
                <div class="prayer-item">
                    <span class="prayer-name">Isha</span>
                    <span class="prayer-time adhan-time" id="ishaAdhan">20:05</span>
                    <span class="prayer-time iqaama-time" id="ishaIqaama">20:20</span>
                </div>
            </section>

            <!-- Search Bar -->
            <section class="search-section">
                <div class="search-bar" onclick="document.getElementById('searchInput').focus()">
                    <i class="fas fa-search" style="cursor: pointer;"></i>
                    <input type="text" placeholder="Search here..." id="searchInput" autocomplete="off">
                    <button class="search-clear-btn" id="searchClear" style="display: none; background: none; border: none; color: #666; cursor: pointer; padding: 4px;">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </section>

            <!-- Inline Search Results -->
            <div id="searchContainer" style="display: none; margin: 0 20px 20px 20px;">
                <div id="searchLoading" class="search-loading" style="display: none; text-align: center; padding: 20px;">
                    <i class="fas fa-spinner fa-spin" style="font-size: 24px; color: var(--primary-green);"></i>
                    <p style="margin-top: 10px; color: #666;">Searching...</p>
                </div>
                <div id="searchResults"></div>
                <div id="searchPagination"></div>
            </div>

            <!-- Quick Access Grid -->
            <section class="quick-access">
                <h3 class="section-title">What do you need?</h3>
                <div class="grid-container">
                    <div class="grid-item" onclick="navigateTo('programs.html')">
                        <div class="grid-icon">
                            <i class="fas fa-book"></i>
                        </div>
                        <span class="grid-label">Programs</span>
                    </div>
                    <div class="grid-item" onclick="navigateTo('programs.html')">
                        <div class="grid-icon">
                            <i class="fas fa-quran"></i>
                        </div>
                        <span class="grid-label">Quran</span>
                    </div>
                    <div class="grid-item" onclick="navigateTo('activities.html')">
                        <div class="grid-icon">
                            <i class="fas fa-running"></i>
                        </div>
                        <span class="grid-label">Activities</span>
                    </div>
                    <div class="grid-item" onclick="navigateTo('events.html')">
                        <div class="grid-icon">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <span class="grid-label">Events</span>
                    </div>
                    <div class="grid-item" onclick="navigateTo('leadership.html')">
                        <div class="grid-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <span class="grid-label">Leadership</span>
                    </div>
                    <div class="grid-item" onclick="navigateTo('pay.html')">
                        <div class="grid-icon">
                            <i class="fas fa-hand-holding-heart"></i>
                        </div>
                        <span class="grid-label">Donations</span>
                    </div>
                    <div class="grid-item" onclick="navigateTo('ask-question.html')">
                        <div class="grid-icon">
                            <i class="fas fa-question-circle"></i>
                        </div>
                        <span class="grid-label">Ask Question</span>
                    </div>
                    <div class="grid-item" onclick="navigateTo('contact.html')">
                        <div class="grid-icon">
                            <i class="fas fa-cog"></i>
                        </div>
                        <span class="grid-label">Settings</span>
                    </div>
                </div>
            </section>

            <!-- Recent Activities -->
            <section class="recent-section">
                <h3 class="section-title">Recent Activities</h3>
                <div class="activity-card">
                    <div class="activity-icon"><i class="fas fa-book-open"></i></div>
                    <div class="activity-content">
                        <h4>Weekly Quran Study</h4>
                        <p>Every Friday 7:15 PM</p>
                        <span class="activity-badge">You come get a personal teacher</span>
                    </div>
                </div>
                <div class="activity-card">
                    <div class="activity-icon"><i class="fas fa-handshake"></i></div>
                    <div class="activity-content">
                        <h4>Mosque Iftar</h4>
                        <p>Ramadhan 7:10 PM</p>
                        <span class="activity-badge success">Confirmed</span>
                    </div>
                </div>
            </section>
        </main>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav">
            <a href="index.html" class="nav-item active">
                <i class="fas fa-home"></i>
                <span>Home</span>
            </a>
            <a href="programs.html" class="nav-item">
                <i class="fas fa-book"></i>
                <span>Programs</span>
            </a>
            <a href="events.html" class="nav-item">
                <i class="fas fa-calendar"></i>
                <span>Events</span>
            </a>
            <a href="pay.html" class="nav-item">
                <i class="fas fa-credit-card"></i>
                <span>Pay</span>
            </a>
            <a href="join-us.html" class="nav-item">
                <i class="fas fa-user-plus"></i>
                <span>Join</span>
            </a>
        </nav>
    </div>

    <!-- Floating Kizumu Visit Button -->
    <div class="floating-kizumu-btn" onclick="showActivitiesModal()">
        <i class="fas fa-heart"></i>
        <span>Kizumu Visit</span>
    </div>

    <!-- Activities Modal -->
    <div class="modal-overlay" id="activitiesModal" style="display: none;">
        <div class="modal-content activities-modal">
            <div class="modal-header">
                <h3><i class="fas fa-heart"></i> Important Activities</h3>
                <button class="modal-close" onclick="closeActivitiesModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="activities-modal-list">
                <div class="activity-modal-item" onclick="navigateToActivity('kizumu-visit')">
                    <div class="activity-modal-icon" style="background: #E91E63;">
                        <i class="fas fa-heart"></i>
                    </div>
                    <div class="activity-modal-text">
                        <h4>Kizumu Tahfiz Charity Visit</h4>
                        <p>Support Islamic education through charity visit</p>
                    </div>
                    <i class="fas fa-chevron-right"></i>
                </div>
                
                <div class="activity-modal-item" onclick="navigateToActivity('tuition-brothers')">
                    <div class="activity-modal-icon" style="background: var(--primary-green);">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div class="activity-modal-text">
                        <h4>Tuition for Brothers</h4>
                        <p>Support brothers' education and learning</p>
                    </div>
                    <i class="fas fa-chevron-right"></i>
                </div>
                
                <div class="activity-modal-item" onclick="navigateToActivity('activities')">
                    <div class="activity-modal-icon" style="background: #FF9800;">
                        <i class="fas fa-running"></i>
                    </div>
                    <div class="activity-modal-text">
                        <h4>View All Activities</h4>
                        <p>See all community activities and events</p>
                    </div>
                    <i class="fas fa-chevron-right"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Account Modal (Login/Create Account/Account Info) -->
    <div class="modal-overlay" id="accountModal" style="display: none;">
        <div class="modal-content account-modal">
            <!-- Login/Signup Tabs -->
            <div id="accountTabs" style="display: none;">
                <div class="account-tabs">
                    <button class="account-tab active" id="loginTab" onclick="showLoginTab()">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                    <button class="account-tab" id="signupTab" onclick="showSignupTab()">
                        <i class="fas fa-user-plus"></i> Create Account
                    </button>
                </div>
            </div>

            <div class="modal-header">
                <h3 id="accountModalTitle"><i class="fas fa-user-circle"></i> Account</h3>
                <button class="modal-close" onclick="closeAccountModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="modal-body">
                <!-- Login Form -->
                <form id="loginFormElement" onsubmit="handleLogin(event)" style="display: none;">
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-input" id="loginEmail" placeholder="your.email@example.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-input" id="loginPassword" placeholder="Enter your password" required>
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 15px;">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                    <p style="text-align: center; margin-top: 15px; font-size: 14px; color: var(--text-gray);">
                        Don't have an account? <a href="#" onclick="showSignupTab(); return false;" style="color: var(--primary-green); font-weight: 600;">Create one</a>
                    </p>
                </form>

                <!-- Signup Form -->
                <form id="signupFormElement" onsubmit="handleSignup(event)" style="display: none;">
                    <div class="form-group">
                        <label class="form-label">First Name</label>
                        <input type="text" class="form-input" id="signupFirstName" placeholder="Enter your first name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Last Name</label>
                        <input type="text" class="form-input" id="signupLastName" placeholder="Enter your last name" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email</label>
                        <input type="email" class="form-input" id="signupEmail" placeholder="your.email@example.com" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">WhatsApp Number</label>
                        <input type="tel" class="form-input" id="signupWhatsApp" placeholder="+256 703 268 522" required>
                        <p style="font-size: 12px; color: var(--text-gray); margin-top: 5px;">Include country code (e.g., +256)</p>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Gender</label>
                        <select class="form-input" id="signupGender" required>
                            <option value="">Select gender</option>
                            <option value="Male">Male</option>
                            <option value="Female">Female</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Position</label>
                        <select class="form-input" id="signupPosition" required>
                            <option value="">Select your position</option>
                            <option value="Student">Student</option>
                            <option value="Lecturer">Lecturer</option>
                            <option value="Staff">Staff</option>
                            <option value="Alumni">Alumni</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-input" id="signupPassword" placeholder="At least 6 characters" required minlength="6">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Confirm Password</label>
                        <input type="password" class="form-input" id="signupConfirmPassword" placeholder="Confirm your password" required minlength="6">
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 15px;">
                        <i class="fas fa-user-plus"></i> Create Account
                    </button>
                    <p style="text-align: center; margin-top: 15px; font-size: 14px; color: var(--text-gray);">
                        Already have an account? <a href="#" onclick="showLoginTab(); return false;" style="color: var(--primary-green); font-weight: 600;">Login</a>
                    </p>
                </form>

                <!-- Account Info -->
                <div id="accountInfo" style="display: none; max-height: 70vh; overflow-y: auto;">
                    <!-- User Profile Section -->
                    <div class="account-info-card" style="margin-bottom: 15px;">
                        <div class="account-avatar">
                            <i class="fas fa-user-circle"></i>
                        </div>
                        <h3 id="accountName" style="text-align: center; margin: 15px 0 5px 0; color: var(--dark-gray);"></h3>
                        <p style="text-align: center; color: var(--text-gray); margin-bottom: 5px;">
                            <i class="fas fa-envelope"></i> <span id="accountEmail"></span>
                        </p>
                        <p style="text-align: center; color: var(--text-gray); margin-bottom: 5px;">
                            <i class="fas fa-venus-mars"></i> <span id="accountGender"></span>
                        </p>
                        <p style="text-align: center; color: var(--text-gray); margin-bottom: 15px;">
                            <i class="fas fa-briefcase"></i> <span id="accountPosition"></span>
                        </p>
                        <button class="btn btn-outline" onclick="showEditProfile()" style="width: 100%; margin-bottom: 10px;">
                            <i class="fas fa-edit"></i> Edit Profile
                        </button>
                        <button class="btn btn-secondary" onclick="handleLogout()" style="width: 100%;">
                            <i class="fas fa-sign-out-alt"></i> Logout
                        </button>
                    </div>
                    
                    <!-- Edit Profile Form (hidden by default) -->
                    <div id="editProfileForm" style="display: none; margin-bottom: 15px; padding: 15px; background: #f9f9f9; border-radius: 10px;">
                        <h4 style="margin: 0 0 15px 0; color: var(--dark-gray);"><i class="fas fa-user-edit"></i> Edit Profile</h4>
                        <div class="form-group" style="margin-bottom: 12px;">
                            <label class="form-label" style="font-size: 13px;">First Name</label>
                            <input type="text" class="form-input" id="editFirstName" style="padding: 10px;">
                        </div>
                        <div class="form-group" style="margin-bottom: 12px;">
                            <label class="form-label" style="font-size: 13px;">Last Name</label>
                            <input type="text" class="form-input" id="editLastName" style="padding: 10px;">
                        </div>
                        <div class="form-group" style="margin-bottom: 12px;">
                            <label class="form-label" style="font-size: 13px;">WhatsApp Number</label>
                            <input type="tel" class="form-input" id="editWhatsApp" style="padding: 10px;">
                        </div>
                        <div class="form-group" style="margin-bottom: 12px;">
                            <label class="form-label" style="font-size: 13px;">Position/Role</label>
                            <input type="text" class="form-input" id="editPosition" style="padding: 10px;">
                        </div>
                        <div style="display: flex; gap: 10px;">
                            <button class="btn btn-primary" onclick="saveProfileChanges()" style="flex: 1; padding: 10px;">
                                <i class="fas fa-save"></i> Save
                            </button>
                            <button class="btn btn-secondary" onclick="hideEditProfile()" style="flex: 1; padding: 10px;">
                                Cancel
                            </button>
                        </div>
                    </div>
                    
                    <!-- Contact Developers -->
                    <div style="margin-bottom: 15px; padding: 15px; background: #f0f7f0; border-radius: 10px;">
                        <h4 style="margin: 0 0 12px 0; color: var(--dark-gray);"><i class="fas fa-code"></i> Contact Developers</h4>
                        <p style="font-size: 12px; color: var(--text-gray); margin-bottom: 12px;">Technical support or bug reports:</p>
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            <a href="https://wa.me/256700000001" target="_blank" style="display: flex; align-items: center; gap: 10px; padding: 10px 12px; background: #25D366; color: white; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 14px;">
                                <i class="fab fa-whatsapp" style="font-size: 18px;"></i> Developer 1
                            </a>
                            <a href="https://wa.me/256700000002" target="_blank" style="display: flex; align-items: center; gap: 10px; padding: 10px 12px; background: #25D366; color: white; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 14px;">
                                <i class="fab fa-whatsapp" style="font-size: 18px;"></i> Developer 2
                            </a>
                        </div>
                    </div>
                    
                    <!-- KIUMA Contacts -->
                    <div style="padding: 15px; background: #f5f5f5; border-radius: 10px;">
                        <h4 style="margin: 0 0 12px 0; color: var(--dark-gray);"><i class="fas fa-phone-alt"></i> KIUMA Contacts</h4>
                        <div style="font-size: 13px; color: var(--text-gray);">
                            <p style="margin: 8px 0; display: flex; align-items: center; gap: 8px;">
                                <i class="fas fa-phone" style="color: var(--primary-green);"></i>
                                <a href="tel:+256703268522" style="color: var(--dark-gray);">+256 703 268 522</a>
                            </p>
                            <p style="margin: 8px 0; display: flex; align-items: center; gap: 8px;">
                                <i class="fas fa-envelope" style="color: var(--primary-green);"></i>
                                <a href="mailto:info@kiuma.kiu.ac.ug" style="color: var(--dark-gray);">info@kiuma.kiu.ac.ug</a>
                            </p>
                            <p style="margin: 8px 0; display: flex; align-items: center; gap: 8px;">
                                <i class="fas fa-map-marker-alt" style="color: var(--primary-green);"></i>
                                <span>KIU Western Campus, Ishaka</span>
                            </p>
                            <a href="https://wa.me/256703268522" target="_blank" style="display: flex; align-items: center; justify-content: center; gap: 8px; margin-top: 12px; padding: 10px; background: #25D366; color: white; text-decoration: none; border-radius: 8px; font-weight: 600; font-size: 14px;">
                                <i class="fab fa-whatsapp"></i> WhatsApp KIUMA
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
    <script src="firebase-config.js"></script>
    <script src="script.js"></script>
    <script src="js/search-data.js"></script>
    <script>
        // Inline search functionality for home page
        class HomeSearch {
            constructor() {
                this.searchInput = document.getElementById('searchInput');
                this.searchClear = document.getElementById('searchClear');
                this.searchContainer = document.getElementById('searchContainer');
                this.searchResults = document.getElementById('searchResults');
                this.searchLoading = document.getElementById('searchLoading');
                this.searchPagination = document.getElementById('searchPagination');
                this.quickAccess = document.querySelector('.quick-access');
                
                this.currentPage = 1;
                this.resultsPerPage = 6;
                this.currentResults = [];
                this.debounceTimer = null;
                
                this.init();
            }
            
            init() {
                if (!this.searchInput) return;
                
                this.searchInput.addEventListener('input', (e) => {
                    this.handleInput(e.target.value);
                });
                
                if (this.searchClear) {
                    this.searchClear.addEventListener('click', (e) => {
                        e.stopPropagation();
                        this.clearSearch();
                    });
                }
            }
            
            handleInput(query) {
                if (this.searchClear) {
                    this.searchClear.style.display = query.length > 0 ? 'block' : 'none';
                }
                
                clearTimeout(this.debounceTimer);
                this.debounceTimer = setTimeout(() => {
                    this.performSearch(query);
                }, 300);
            }
            
            performSearch(query) {
                query = query.trim().toLowerCase();
                
                if (query.length === 0) {
                    this.hideResults();
                    return;
                }
                
                if (query.length < 2) return;
                
                this.showLoading();
                
                setTimeout(() => {
                    const results = this.search(query);
                    this.currentResults = results;
                    this.currentPage = 1;
                    this.displayResults(results);
                }, 150);
            }
            
            search(query) {
                if (typeof SEARCH_DATA === 'undefined') return [];
                
                const queryWords = query.split(/\s+/).filter(w => w.length > 0);
                const results = [];
                
                SEARCH_DATA.forEach(item => {
                    let score = 0;
                    const titleLower = item.title.toLowerCase();
                    const descLower = item.description.toLowerCase();
                    const keywordsStr = item.keywords.join(' ').toLowerCase();
                    
                    queryWords.forEach(word => {
                        if (titleLower === word) score += 100;
                        else if (titleLower.includes(word)) score += 50;
                        if (item.keywords.some(k => k.toLowerCase() === word)) score += 40;
                        else if (keywordsStr.includes(word)) score += 20;
                        if (descLower.includes(word)) score += 10;
                    });
                    
                    if (score > 0) results.push({...item, score});
                });
                
                return results.sort((a, b) => b.score - a.score);
            }
            
            displayResults(results) {
                this.hideLoading();
                
                if (results.length === 0) {
                    this.showNoResults();
                    return;
                }
                
                if (this.quickAccess) this.quickAccess.style.display = 'none';
                if (this.searchContainer) this.searchContainer.style.display = 'block';
                
                const startIndex = (this.currentPage - 1) * this.resultsPerPage;
                const pageResults = results.slice(startIndex, startIndex + this.resultsPerPage);
                
                let html = `<div style="margin-bottom: 12px; color: #666; font-size: 14px;">${results.length} result${results.length !== 1 ? 's' : ''} found</div>`;
                html += '<div style="display: flex; flex-direction: column; gap: 10px;">';
                
                pageResults.forEach(item => {
                    const color = CATEGORY_COLORS[item.category] || '#4CAF50';
                    html += `
                        <a href="${item.url}" style="display: flex; align-items: center; gap: 12px; background: white; border-radius: 12px; padding: 12px; text-decoration: none; box-shadow: 0 2px 6px rgba(0,0,0,0.08); border: 1px solid #e0e0e0; transition: all 0.2s;">
                            <div style="width: 40px; height: 40px; border-radius: 10px; background: ${color}; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                <i class="fas ${item.icon}" style="color: white; font-size: 16px;"></i>
                            </div>
                            <div style="flex: 1; min-width: 0;">
                                <div style="font-weight: 600; color: #333; font-size: 14px;">${item.title}</div>
                                <div style="font-size: 12px; color: #666; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">${item.description}</div>
                            </div>
                            <i class="fas fa-chevron-right" style="color: #ccc; font-size: 12px;"></i>
                        </a>`;
                });
                
                html += '</div>';
                if (this.searchResults) this.searchResults.innerHTML = html;
                
                this.renderPagination(results.length);
            }
            
            renderPagination(total) {
                if (!this.searchPagination) return;
                const totalPages = Math.ceil(total / this.resultsPerPage);
                if (totalPages <= 1) { this.searchPagination.innerHTML = ''; return; }
                
                let html = '<div style="display: flex; justify-content: center; gap: 8px; margin-top: 15px;">';
                for (let i = 1; i <= totalPages; i++) {
                    const active = i === this.currentPage;
                    html += `<button onclick="homeSearch.goToPage(${i})" style="padding: 6px 12px; border: 1px solid ${active ? '#4CAF50' : '#e0e0e0'}; background: ${active ? '#4CAF50' : 'white'}; color: ${active ? 'white' : '#333'}; border-radius: 6px; cursor: pointer;">${i}</button>`;
                }
                html += '</div>';
                this.searchPagination.innerHTML = html;
            }
            
            goToPage(page) {
                this.currentPage = page;
                this.displayResults(this.currentResults);
            }
            
            showLoading() {
                if (this.quickAccess) this.quickAccess.style.display = 'none';
                if (this.searchContainer) this.searchContainer.style.display = 'block';
                if (this.searchLoading) this.searchLoading.style.display = 'block';
                if (this.searchResults) this.searchResults.innerHTML = '';
                if (this.searchPagination) this.searchPagination.innerHTML = '';
            }
            
            hideLoading() {
                if (this.searchLoading) this.searchLoading.style.display = 'none';
            }
            
            hideResults() {
                if (this.searchContainer) this.searchContainer.style.display = 'none';
                if (this.quickAccess) this.quickAccess.style.display = 'block';
                if (this.searchClear) this.searchClear.style.display = 'none';
            }
            
            showNoResults() {
                if (this.quickAccess) this.quickAccess.style.display = 'none';
                if (this.searchContainer) this.searchContainer.style.display = 'block';
                if (this.searchResults) {
                    this.searchResults.innerHTML = `
                        <div style="text-align: center; padding: 40px 20px; color: #666;">
                            <i class="fas fa-search" style="font-size: 40px; color: #ccc; margin-bottom: 15px;"></i>
                            <h3 style="color: #333; margin-bottom: 8px;">No results found</h3>
                            <p style="font-size: 14px;">Try different keywords</p>
                        </div>`;
                }
                if (this.searchPagination) this.searchPagination.innerHTML = '';
            }
            
            clearSearch() {
                if (this.searchInput) {
                    this.searchInput.value = '';
                    this.searchInput.focus();
                }
                this.hideResults();
                this.currentResults = [];
                this.currentPage = 1;
            }
        }
        
        let homeSearch;
        
        // Initialize user display and modals
        window.addEventListener('DOMContentLoaded', function() {
            loadUserData();
            homeSearch = new HomeSearch();
            
            // Close modals on overlay click
            document.getElementById('activitiesModal')?.addEventListener('click', function(e) {
                if (e.target === this) {
                    closeActivitiesModal();
                }
            });
            
            document.getElementById('accountModal')?.addEventListener('click', function(e) {
                if (e.target === this) {
                    closeAccountModal();
                }
            });

            // Scroll to charity visit if URL has hash
            if (window.location.hash === '#charity-visit') {
                setTimeout(() => {
                    document.querySelector('.charity-visit-card')?.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    if (document.getElementById('charityDetails')) {
                        document.getElementById('charityDetails').style.display = 'block';
                        const icon = document.getElementById('charityToggleIcon');
                        if (icon) {
                            icon.classList.remove('fa-chevron-down');
                            icon.classList.add('fa-chevron-up');
                        }
                    }
                }, 300);
            }
        });
    </script>
    
    <!-- Service Worker Registration for Offline Support -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(reg => console.log('Service Worker registered:', reg.scope))
                    .catch(err => console.log('Service Worker registration failed:', err));
            });
        }
    </script>
</body>
</html>
